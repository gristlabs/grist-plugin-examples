!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).grainjs=e()}}(function(){return function(){return function e(t,s,n){function o(r,u){if(!s[r]){if(!t[r]){var c="function"==typeof require&&require;if(!u&&c)return c(r,!0);if(i)return i(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=s[r]={exports:{}};t[r][0].call(d.exports,function(e){return o(t[r][1][e]||e)},d,d.exports,e,t,s,n)}return s[r].exports}for(var i="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}}()({1:[function(e,t,s){"use strict";function n(e){for(var t in e)s.hasOwnProperty(t)||(s[t]=e[t])}Object.defineProperty(s,"__esModule",{value:!0});var o=e("./lib/computed");s.Computed=o.Computed,s.computed=o.computed,n(e("./lib/dispose")),n(e("./lib/dom")),n(e("./lib/emit")),n(e("./lib/kowrap")),n(e("./lib/obsArray")),n(e("./lib/observable")),n(e("./lib/styled"));var i=e("./lib/subscribe");s.Subscription=i.Subscription,s.subscribe=i.subscribe,n(e("./lib/util")),n(e("./lib/widgets/input")),n(e("./lib/widgets/select"))},{"./lib/computed":11,"./lib/dispose":12,"./lib/dom":13,"./lib/emit":15,"./lib/kowrap":16,"./lib/obsArray":17,"./lib/observable":18,"./lib/styled":19,"./lib/subscribe":20,"./lib/util":21,"./lib/widgets/input":22,"./lib/widgets/select":23}],2:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.PriorityQueue=class{constructor(e){this._isPrior=e,this._items=[]}get size(){return this._items.length}push(e){const t=this._items,s=this._isPrior;let n=this._items.length;for(;n>0;){const o=n-1>>1,i=t[o];if(s(i,e))break;t[n]=i,n=o}t[n]=e}peek(){return this._items[0]}pop(){if(this._items.length<=1)return this._items.pop();const e=this._items,t=this._isPrior,s=e[0],n=e.pop(),o=this._items.length;let i=0,r=1;for(;r<o;){const s=r+1,u=s<o&&t(e[s],e[r])?s:r;if(t(n,e[u]))break;e[i]=e[u],r=(i=u)+i+1}return e[i]=n,s}}},{}],3:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./PriorityQueue");class o{constructor(e,t){this._priority=0,this._enqueued=!1,this._callback=e,this._context=t}static isPrioritySmaller(e,t){return e._priority<t._priority}useDep(e){const t=e?e._priority:0;t>=this._priority&&(this._priority=t+1)}recompute(){this._priority=0,this._callback.call(this._context)}enqueue(){this._enqueued||(this._enqueued=!0,i.push(this))}}s.DepItem=o;const i=new n.PriorityQueue(o.isPrioritySmaller),r=[];let u=0;function c(){if(0===u&&i.size>0){u++;try{do{const e=i.pop();r.push(e),e.recompute()}while(i.size>0)}finally{for(const e of r)e._enqueued=!1;r.length=0,u--}}}s._getPriority=function(e){const t=e._getDepItem();return t?t._priority:0},s.compute=c,s.bundleChanges=function(e){try{return u++,e()}finally{u--,c()}}},{"./PriorityQueue":2}],4:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./_domDispose"),o=e("./_domImpl"),i=e("./_domMethods"),r=e("./dispose"),u=e("./browserGlobals");class c{constructor(e){this._parentElem=e}autoDispose(e){e.mount(this._parentElem)}}s.Component=class extends r.Disposable{constructor(){super(),this._markerPre=u.G.document.createComment("A"),this._markerPost=u.G.document.createComment("B"),this._contentToMount=null,n.onDisposeElem(this._markerPost,()=>{this._markerPre=this._markerPost=void 0,this.dispose()}),this.onDispose(this._unmount,this)}static create(e,...t){const s=e instanceof u.G.Element?new c(e):e;return r.Disposable.create.call(this,s,...t)}mount(e){if(!this._markerPost)throw new Error("Component mount() called when already disposed");if(this._markerPost.parentNode)throw new Error("Component mount() called twice");o.update(e,this._markerPre,this._contentToMount,this._markerPost),this._contentToMount=null}setContent(e){this._markerPost&&(this._markerPost.parentNode?i.replaceContent(this._markerPre,this._markerPost,e):this._contentToMount=e)}_unmount(){if(this._markerPost&&this._markerPost.parentNode){const e=this._markerPost.parentNode;i.replaceContent(this._markerPre,this._markerPost,null),e.removeChild(this._markerPre),e.removeChild(this._markerPost)}this._markerPre=this._markerPost=void 0}},s.create=function(e,...t){return s=>{e.create(s,...t)}},s.createInit=function(e,...t){return s=>{t.pop()(e.create(s,...t))}}},{"./_domDispose":5,"./_domImpl":7,"./_domMethods":8,"./browserGlobals":10,"./dispose":12}],5:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=new WeakMap;function o(e){let t=n.get(e);if(t){let s=e;do{n.delete(s),t(e),s=t,t=n.get(s)}while(t)}}function i(e,t){const s=n.get(e);n.set(e,t),s&&n.set(t,s)}function r(e,t){t&&i(e,()=>t.dispose())}s.domDispose=function(e){!function e(t,s){let n=t.firstChild;for(;n;)e(n,s),n=n.nextSibling;s(t)}(e,o)},s.onDisposeElem=i,s.onDispose=function(e){return t=>i(t,e)},s.autoDisposeElem=r,s.autoDispose=function(e){if(e)return t=>r(t,e)}},{}],6:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./_domDispose"),o=e("./_domImpl"),i=e("./_domMethods"),r=e("./obsArray"),u=e("./browserGlobals");s.forEach=function(e,t){return s=>{const c=u.G.document.createComment("a"),l=u.G.document.createComment("b");if(s.appendChild(c),s.appendChild(l),Array.isArray(e))return void i.replaceContent(c,l,e.map(t));const d=r.computedArray(e,t);d.addListener((e,t,r)=>{if(r){for(const e of r.deleted)e&&e.parentNode===s&&(n.domDispose(e),s.removeChild(e));if(r.numAdded>0){const t=r.start+r.numAdded;let n=l;for(let o=t;o<e.length;o++){const t=e[o];if(t&&t.parentNode===s){n=t;break}}const i=o.frag(e.slice(r.start,t));s.insertBefore(i,n)}}else i.replaceContent(c,l,e)}),i.replaceContent(c,l,d.get())}}},{"./_domDispose":5,"./_domImpl":7,"./_domMethods":8,"./browserGlobals":10,"./obsArray":17}],7:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./_domDispose"),o=e("./_domMethods"),i=e("./browserGlobals");function r(e){return i.G.document.createElement(e)}function u(e){return i.G.document.createElementNS("http://www.w3.org/2000/svg",e)}function c(e,t){let s,n,o,i=t.indexOf(".");const r=t.indexOf("#");if(-1===i?i=t.length:o=t.substring(i+1).replace(/\./g," "),-1===r)s=t.substring(0,i);else{if(r>i)throw new Error(`ID must come before classes in dom("${t}")`);s=t.substring(0,r),n=t.substring(r+1,i)}const u=e(s);return n&&u.setAttribute("id",n),o&&u.setAttribute("class",o),u}function l(e,t){for(const s of t)a(e,s);return e}function d(e,t){try{return l(e,t)}catch(t){throw n.domDispose(e),t}}function a(e,t){if("function"==typeof t){const s=t(e);void 0!==s&&null!==s&&a(e,s)}else Array.isArray(t)?l(e,t):void 0===t||null===t||(t instanceof i.G.Node?e.appendChild(t):"object"==typeof t?o.attrsElem(e,t):e.appendChild(i.G.document.createTextNode(t)))}s.dom=function(e,...t){return d(c(r,e),t)},s.svg=function(e,...t){return d(c(u,e),t)},s.update=function(e,...t){return l(e,t)},s.frag=function(...e){return d(i.G.document.createDocumentFragment(),e)},s.find=function(e){return i.G.document.querySelector(e)},s.findAll=function(e){return i.G.document.querySelectorAll(e)}},{"./_domDispose":5,"./_domMethods":8,"./browserGlobals":10}],8:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./_domDispose"),o=e("./_domImpl"),i=e("./binding"),r=e("./browserGlobals"),u=new WeakMap;function c(e,t,s){n.autoDisposeElem(e,i.subscribe(t,s))}function l(e,t){for(const s of Object.keys(t)){const n=t[s];null!=n&&!1!==n&&e.setAttribute(s,!0===n?"":n)}}function d(e,t,s){null===s||void 0===s?e.removeAttribute(t):e.setAttribute(t,s)}function a(e,t,s){d(e,t,s?"":null)}function h(e,t,s){e.style[t]=s}function p(e,t,s){e[t]=s}function _(e,t){e.style.display=t?"":"none"}function m(e,t){e.style.display=t?"none":""}function f(e,t,s=!0){e.classList.toggle(t,Boolean(s))}function b(e,t){return"string"!=typeof e?y("",e):t&&"boolean"!=typeof t?s=>c(s,t,t=>f(s,e,t)):s=>f(s,e,t)}function g(e,t,s){return"string"!=typeof t?y(e,t):b(e+t,s)}function y(e,t){return s=>{let n=null;c(s,t,t=>{n&&s.classList.remove(n),(n=t?e+t:null)&&s.classList.add(n)})}}function v(e,t,s){const o=u.get(e);o?o[t]=s:(n.onDisposeElem(e,()=>u.delete(e)),u.set(e,{[t]:s}))}function w(e,t,s){const i=e.parentNode;if(i){let u;for(let s=e.nextSibling;s&&s!==t;s=u)u=s.nextSibling,n.domDispose(s),i.removeChild(s);s&&i.insertBefore(s instanceof r.G.Node?s:o.frag(s),t)}}function C(e,t){const s=t||D;return t=>{const n=r.G.document.createComment("a"),o=r.G.document.createComment("b");t.appendChild(n),t.appendChild(o),c(t,e,e=>w(n,o,s(e)))}}function D(e){return e}s.attrsElem=l,s.attrs=function(e){return t=>l(t,e)},s.attrElem=d,s.attr=function(e,t){return s=>c(s,t,t=>d(s,e,t))},s.boolAttrElem=a,s.boolAttr=function(e,t){return s=>c(s,t,t=>a(s,e,t))},s.textElem=function(e,t){e.appendChild(r.G.document.createTextNode(t))},s.text=function(e){return t=>{const s=r.G.document.createTextNode("");c(t,e,e=>{s.nodeValue=e}),t.appendChild(s)}},s.styleElem=h,s.style=function(e,t){return s=>c(s,t,t=>h(s,e,t))},s.propElem=p,s.prop=function(e,t){return s=>c(s,t,t=>p(s,e,t))},s.showElem=_,s.show=function(e){return t=>c(t,e,e=>_(t,e))},s.hideElem=m,s.hide=function(e){return t=>c(t,e,e=>m(t,e))},s.clsElem=f,s.cls=b,s.clsPrefix=g,s.dataElem=v,s.data=function(e,t){return s=>c(s,t,t=>v(s,e,t))},s.getData=function(e,t){const s=u.get(e);return s&&s[t]},s.replaceContent=w,s.domComputed=C,s.maybe=function(e,t){return C(e,e=>e?t(e):null)},s.makeTestId=function(e){return g.bind(null,e)},s.noTestId=(e=>null)},{"./_domDispose":5,"./_domImpl":7,"./binding":9,"./browserGlobals":10}],9:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./computed"),o=e("./observable");s.subscribe=function(e,t){if("function"==typeof e){const s=e;if("function"==typeof s.peek){let e=s.peek();const n=s.subscribe(s=>{const n=e;e=s,t(s,n)});return t(e,void 0),n}const o=n.computed(e);return o.addListener(t),t(o.get(),void 0),o}if(e instanceof o.Observable){const s=e.addListener(t);return t(e.get(),void 0),s}return t(e,void 0),null}},{"./computed":11,"./observable":18}],10:[function(e,t,s){"use strict";function n(e,t){e.DocumentFragment=t.DocumentFragment,e.Element=t.Element,e.Node=t.Node,e.document=t.document,e.window=t.window}Object.defineProperty(s,"__esModule",{value:!0});const o={};n(o,"undefined"!=typeof window?window:{}),s.G=Object.assign({},o);const i=[o];s.pushGlobals=function(e){i.push(e),n(s.G,e)},s.popGlobals=function(){i.length>1&&i.pop(),n(s.G,i[i.length-1])}},{}],11:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./observable"),o=e("./subscribe");function i(){throw new Error("Can't write to non-writable computed")}class r extends n.Observable{constructor(e,t){super(void 0),this._callback=e,this._write=i,this._sub=new o.Subscription(this._read.bind(this),t,this)}_getDepItem(){return this._sub._getDepItem()}set(e){this._write(e)}onWrite(e){return this._write=e,this}dispose(){this._sub.dispose(),super.dispose()}_read(e,...t){super.set(this._callback(e,...t))}}s.Computed=r,s.computed=function(...e){const t=e.pop();return new r(t,e)}},{"./observable":18,"./subscribe":20}],12:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./emit");let o={autoDispose(e){}};class i{constructor(){this._disposalList=new l,o.autoDispose(this)}static create(e,...t){const s=o,n=new r;try{return o=n,u(e,new this(...t))}catch(e){try{n.clear()}catch(e){console.error("Error disposing partially constructed %s:",this.name,e)}throw e}finally{n.release(),o=s}}autoDispose(e){return this.onDispose(e.dispose,e),e}onDispose(e,t){this._disposalList.addListener(e,t)}wipeOnDispose(){this.onDispose(this._wipeOutObject,this)}isDisposed(){return null===this._disposalList}dispose(){const e=this._disposalList;this._disposalList=null,e.callAndDispose(this)}_wipeOutObject(){for(const e of Object.keys(this))this[e]=null}}s.Disposable=i;class r{constructor(){this._owned=null}static create(e){return u(e,new r)}autoDispose(e){return this._owned&&this._owned.dispose(),this._owned=e,e instanceof i&&e.onDispose(this.release,this),e}release(){const e=this._owned;return this._owned=null,e}clear(){this._owned&&(this._owned.dispose(),this._owned=null)}get(){return this._owned}isEmpty(){return!this._owned}dispose(){this.clear()}}function u(e,t){return e&&e.autoDispose(t),t}function c(e){return e&&e.constructor&&e.constructor.name?e.constructor.name:""+e}s.Holder=r,s.setDisposeOwner=u;class l extends n.LLink{constructor(){super()}addListener(e,t){const s=new d(e,t);this._insertBefore(this._next,s)}callAndDispose(e){try{d.callAll(this._next,this,e)}finally{this._disposeList()}}}class d extends n.LLink{constructor(e,t){super(),this.callback=e,this.context=t}static callAll(e,t,s){for(;e!==t;){const t=e;try{t.callback.call(t.context)}catch(e){console.error("While disposing %s, error disposing %s: %s",c(s),c(this),e)}e=t._next}}}},{"./emit":15}],13:[function(e,t,s){"use strict";function n(e){for(var t in e)s.hasOwnProperty(t)||(s[t]=e[t])}Object.defineProperty(s,"__esModule",{value:!0});var o=e("./_domImpl");s.svg=o.svg,s.update=o.update,s.frag=o.frag,s.find=o.find,s.findAll=o.findAll,n(e("./_domComponent")),n(e("./_domDispose")),n(e("./_domForEach")),n(e("./_domMethods")),n(e("./domevent"));const i=e("./_domComponent"),r=e("./_domDispose"),u=e("./_domForEach"),c=e("./_domImpl"),l=e("./_domMethods"),d=e("./domevent");function a(e,...t){return c.dom(e,...t)}s.dom=a,function(e){e.svg=c.svg,e.frag=c.frag,e.update=c.update,e.find=c.find,e.findAll=c.findAll,e.domDispose=r.domDispose,e.onDisposeElem=r.onDisposeElem,e.onDispose=r.onDispose,e.autoDisposeElem=r.autoDisposeElem,e.autoDispose=r.autoDispose,e.attrsElem=l.attrsElem,e.attrs=l.attrs,e.attrElem=l.attrElem,e.attr=l.attr,e.boolAttrElem=l.boolAttrElem,e.boolAttr=l.boolAttr,e.textElem=l.textElem,e.text=l.text,e.styleElem=l.styleElem,e.style=l.style,e.propElem=l.propElem,e.prop=l.prop,e.showElem=l.showElem,e.show=l.show,e.hideElem=l.hideElem,e.hide=l.hide,e.clsElem=l.clsElem,e.cls=l.cls,e.clsPrefix=l.clsPrefix,e.dataElem=l.dataElem,e.data=l.data,e.getData=l.getData,e.replaceContent=l.replaceContent,e.domComputed=l.domComputed,e.maybe=l.maybe,e.forEach=u.forEach,e.Component=i.Component,e.create=i.create,e.createInit=i.createInit,e.onElem=d.onElem,e.on=d.on,e.onMatchElem=d.onMatchElem,e.onMatch=d.onMatch,e.onKeyPressElem=d.onKeyPressElem,e.onKeyPress=d.onKeyPress}(a=s.dom||(s.dom={}))},{"./_domComponent":4,"./_domDispose":5,"./_domForEach":6,"./_domImpl":7,"./_domMethods":8,"./domevent":14}],14:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});class n{constructor(e,t,s,n,o){this.elem=e,this.eventType=t,this.callback=s,this.useCapture=n,this.selector=o,this.elem.addEventListener(this.eventType,this,this.useCapture)}handleEvent(e){(0,this.callback)(e,this.elem)}dispose(){this.elem.removeEventListener(this.eventType,this,this.useCapture)}}class o extends n{handleEvent(e){const t=function(e,t,s){for(let n=e;n&&n!==t;n=n.parentElement)if(n.matches(s))return n;return null}(e.target,this.elem,this.selector);if(t){(0,this.callback)(e,t)}}}function i(e,t,s,{useCapture:o=!1}={}){return new n(e,t,s,o)}function r(e,t){return i(e,"keypress",(e,s)=>{const n=t[e.key];n&&n(e,s)})}s.onElem=i,s.on=function(e,t,{useCapture:s=!1}={}){return o=>{new n(o,e,t,s)}},s.onMatchElem=function(e,t,s,n,{useCapture:i=!1}={}){return new o(e,s,n,i,t)},s.onMatch=function(e,t,s,{useCapture:n=!1}={}){return i=>{new o(i,t,s,n,e)}},s.onKeyPressElem=r,s.onKeyPress=function(e){return t=>{r(t,e)}}},{}],15:[function(e,t,s){"use strict";function n(){}Object.defineProperty(s,"__esModule",{value:!0});class o{constructor(){this._next=null,this._prev=null,this._next=this,this._prev=this}isDisposed(){return!this._next}_insertBefore(e,t){const s=e._prev;s._next=t,e._prev=t,t._prev=s,t._next=e}_removeNode(e){e._prev&&(e._prev._next=e._next,e._next._prev=e._prev),e._prev=e._next=null}_disposeList(){let e=this,t=e._next;for(;null!==t;)e._next=e._prev=null,t=(e=t)._next}}s.LLink=o;s.Emitter=class extends o{constructor(){super(),this._changeCB=n,this._changeCBContext=void 0}addListener(e,t){return new i(this,e,t)}emit(...e){i.callAll(this._next,this,e)}setChangeCB(e,t){this._changeCB=e||n,this._changeCBContext=t}_triggerChangeCB(){this._changeCB.call(this._changeCBContext,this.hasListeners())}hasListeners(){return this._next!==this}dispose(){this._disposeList(),this._changeCB=n,this._changeCBContext=void 0}};class i extends o{constructor(e,t,s){super(),this.emitter=e,this.callback=t,this.context=s,this._insertBefore(e,this),e._triggerChangeCB()}static callAll(e,t,s){for(;e!==t;){const t=e;t.callback.call(t.context,...s),e=t._next}}dispose(){this.isDisposed()||(this._removeNode(this),this.emitter._triggerChangeCB())}}s.Listener=i},{}],16:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./observable"),o=new WeakMap,i=new WeakMap;s.fromKo=function(e){const t=o.get(e);if(t)return t;const s=n.observable(e.peek());return o.set(e,s),e.subscribe(e=>s.set(e)),s},s.toKo=function(e,t){const s=i.get(t);if(s)return s;const n=e.observable(t.get());return i.set(t,n),t.addListener(e=>n(e)),n}},{"./observable":18}],17:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./dispose"),o=e("./observable"),i=e("./subscribe");class r extends o.BaseObservable{constructor(){super(...arguments),this._ownedItems=void 0}addListener(e,t){return super.addListener(e,t)}autoDispose(e){return this._ownedItems||(this._ownedItems=new Set),this._ownedItems.add(e),e}dispose(){if(this._ownedItems){for(const e of this.get())this._ownedItems.delete(e)&&e.dispose();this._ownedItems=void 0}super.dispose()}_setWithSplice(e,t){return this._setWithArg(e,t)}_disposeOwned(e){if(this._ownedItems)if(e)for(const t of e.deleted)this._ownedItems.delete(t)&&t.dispose();else{const e=this._ownedItems;this._ownedItems=new Set;for(const t of this.get())e.delete(t)&&this._ownedItems.add(t);for(const t of e)t.dispose()}}}s.ObsArray=r;class u extends r{push(...e){const t=this.get(),s=t.length,n=t.push(...e);return this._setWithSplice(t,{start:s,numAdded:e.length,deleted:[]}),n}pop(){const e=this.get();if(0===e.length)return;const t=e.pop();return this._setWithSplice(e,{start:e.length,numAdded:0,deleted:[t]}),t}unshift(...e){const t=this.get(),s=t.unshift(...e);return this._setWithSplice(t,{start:0,numAdded:e.length,deleted:[]}),s}shift(){const e=this.get();if(0===e.length)return;const t=e.shift();return this._setWithSplice(e,{start:0,numAdded:0,deleted:[t]}),t}splice(e,t=1/0,...s){const n=this.get(),o=n.length;e=Math.min(o,Math.max(0,e<0?o+e:e));const i=n.splice(e,t,...s);return this._setWithSplice(n,{start:e,numAdded:s.length,deleted:i}),i}}s.MutableObsArray=u,s.obsArray=function(e=[]){return new u(e)};class c extends r{constructor(e,t){var s;super([]),this._mapper=t,this._sub=(s=e,Array.isArray(s.get())?i.subscribe(e,t=>this._syncMap(e)):i.subscribe(e,(e,t)=>(e(t),this._syncMap(t))))}dispose(){this._unsync(),this._sub.dispose(),super.dispose()}_syncMap(e){this._source!==e?(this._unsync(),this._listener=e.addListener(this._recordChange,this),this._source=e,this._rebuild(e)):this._lastSplice?this._applySplice(e,this._lastSplice):this._rebuild(e),this._lastSplice=void 0}_unsync(){this._listener&&(this._listener.dispose(),this._listener=void 0,this._source=void 0)}_rebuild(e){this.set(e.get().map((e,t)=>this._mapper.call(void 0,e,t,this)))}_applySplice(e,t){const s=e.get(),n=[];for(let e=t.start,o=0;o<t.numAdded;e++,o++)n.push(this._mapper.call(void 0,s[e],e,this));const o=this.get(),i=o.splice(t.start,t.deleted.length,...n);this._setWithSplice(o,{start:t.start,numAdded:n.length,deleted:i})}_recordChange(e,t,s){s&&void 0===this._lastSplice?this._lastSplice=s:this._lastSplice=!1}}s.ComputedArray=c,s.computedArray=function(e,t){return new c(e,t)},s.makeLiveIndex=function(e,t,s=0){return n.setDisposeOwner(e,new l(t,s))};class l extends o.Observable{constructor(e,t=0){super(null),this._obsArray=e,this._isLive=!0,this.set(t),this._listener=e.addListener(this._onArrayChange,this)}set(e){const t=this._obsArray.get().length;super.set(0===t?null:Math.max(0,Math.min(t-1,e||0)))}setLive(e){this._isLive=e}dispose(){this._listener.dispose(),super.dispose()}_onArrayChange(e,t,s){const n=this.get();this.set(null!==n&&s?this._isLive&&n>=s.start+s.deleted.length?n+s.numAdded-s.deleted.length:this._isLive&&n>=s.start+s.numAdded?s.start+s.numAdded:n:0)}}s.LiveIndex=l},{"./dispose":12,"./observable":18,"./subscribe":20}],18:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./_computed_queue"),o=e("./emit");var i=e("./_computed_queue");s.bundleChanges=i.bundleChanges;class r{constructor(e){this._onChange=new o.Emitter,this._value=e}get(){return this._value}set(e){e!==this._value&&this.setAndTrigger(e)}setAndTrigger(e){const t=this._value;this._value=e,this._onChange.emit(e,t),this._disposeOwned(),n.compute()}addListener(e,t){return this._onChange.addListener(e,t)}hasListeners(){return this._onChange.hasListeners()}setListenerChangeCB(e,t){this._onChange.setChangeCB(e,t)}_getDepItem(){return null}dispose(){this._disposeOwned(),this._onChange.dispose(),this._value=void 0}isDisposed(){return this._onChange.isDisposed()}_disposeOwned(e){}_setWithArg(e,t){const s=this._value;this._value=e,this._onChange.emit(e,s,t),this._disposeOwned(t),n.compute()}}s.BaseObservable=r;class u extends r{constructor(){super(...arguments),this._owned=void 0}static holder(e){const t=new u(e);return t._owned=e,t}autoDispose(e){return this.setAndTrigger(e),this._owned=e,e}_disposeOwned(){this._owned&&(this._owned.dispose(),this._owned=void 0)}}s.Observable=u,s.observable=function(e){return new u(e)},s.obsHolder=function(e){return u.holder(e)}},{"./_computed_queue":3,"./emit":15}],19:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./browserGlobals"),o=e("./dom");s.styled=function(e,t){const s=new i(t),n="string"==typeof e?(...t)=>o.dom(e,...t,s.use()):(...t)=>e(...t,s.use());return Object.assign(n,{className:s.className,cls:o.dom.clsPrefix.bind(null,s.className)})};class i{constructor(e){this._styles=e,this._mounted=!1,this.className=i._nextClassName(),i._unmounted.add(this)}static _nextClassName(){return`_grain${this._next++}`}static _mountAll(){const e=Array.from(this._unmounted,e=>(function(e,t){const s=[],n=t.replace(/([^;]*)\s*{([^}]*)\s*}/g,(t,n,o)=>{const i=n.replace(/&/g,"."+e);return s.push(`${i} {${o}}`),""});return`.${e} {${n}}\n`+s.join("\n")})(e.className,e._styles)).join("\n\n");n.G.document.head.appendChild(o.dom("style",e));for(const e of this._unmounted)e._mounted=!0;this._unmounted.clear()}use(){return this._mounted||i._mountAll(),e=>{e.classList.add(this.className)}}}i._next=1,i._unmounted=new Set},{"./browserGlobals":10,"./dom":13}],20:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("./_computed_queue"),o=[];class i{constructor(e,t,s){this._depItem=new n.DepItem(this._evaluate,this),this._dependencies=t.length>0?t:o,this._depListeners=t.length>0?t.map(e=>this._subscribeTo(e)):o,this._dynDeps=new Map,this._callback=e,this._useFunc=this._useDependency.bind(this),s&&(this._useFunc.owner=s),this._evaluate()}dispose(){this._callback=null;for(const e of this._depListeners)e.dispose();for(const e of this._dynDeps.values())e.dispose()}_getDepItem(){return this._depItem}_useDependency(e){let t=this._dynDeps.get(e);return t||(t=this._subscribeTo(e),this._dynDeps.set(e,t)),t._inUse=!0,this._depItem.useDep(e._getDepItem()),e.get()}_evaluate(){if(null!==this._callback)try{const e=[this._useFunc];for(let t=0,s=this._dependencies.length;t<s;t++)e[t+1]=this._dependencies[t].get(),this._depItem.useDep(this._dependencies[t]._getDepItem());return this._callback.apply(void 0,e)}finally{this._dynDeps.forEach((e,t)=>{e._inUse?e._inUse=!1:(this._dynDeps.delete(t),e.dispose())})}}_subscribeTo(e){return e.addListener(this._enqueue,this)}_enqueue(){this._depItem.enqueue()}}s.Subscription=i,s.subscribe=function(...e){const t=e.pop();return new i(t,e)}},{"./_computed_queue":3}],21:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.bindB=function(e,t){switch(t.length){case 0:return()=>e();case 1:return()=>e(t[0]);case 2:return()=>e(t[0],t[1]);case 3:return()=>e(t[0],t[1],t[2]);case 4:return()=>e(t[0],t[1],t[2],t[3]);case 5:return()=>e(t[0],t[1],t[2],t[3],t[4]);case 6:return()=>e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return()=>e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return()=>e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);default:return()=>e.apply(void 0,t)}},s.bindUB=function(e,t){switch(t.length){case 0:return t=>e(t);case 1:return s=>e(s,t[0]);case 2:return s=>e(s,t[0],t[1]);case 3:return s=>e(s,t[0],t[1],t[2]);case 4:return s=>e(s,t[0],t[1],t[2],t[3]);case 5:return s=>e(s,t[0],t[1],t[2],t[3],t[4]);case 6:return s=>e(s,t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return s=>e(s,t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return s=>e(s,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);default:return s=>e(s,...t)}},s.bindBU=function(e,t){switch(t.length){case 0:return t=>e(t);case 1:return s=>e(t[0],s);case 2:return s=>e(t[0],t[1],s);case 3:return s=>e(t[0],t[1],t[2],s);case 4:return s=>e(t[0],t[1],t[2],t[3],s);case 5:return s=>e(t[0],t[1],t[2],t[3],t[4],s);case 6:return s=>e(t[0],t[1],t[2],t[3],t[4],t[5],s);case 7:return s=>e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],s);case 8:return s=>e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],s);default:return s=>e(...t,s)}}},{}],22:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("../../index");s.input=function(e,t,...s){const o=t.isValid;function i(t){const s=t;n.bundleChanges(()=>{e.set(s.value),o&&o.set(s.validity.valid)})}return n.dom("input",...s,n.dom.prop("value",e),o?t=>n.dom.autoDisposeElem(t,n.subscribe(e,e=>o.set(t.checkValidity()))):null,t.onInput?n.dom.on("input",(e,t)=>i(t)):null,n.dom.on("change",(e,t)=>i(t)),n.dom.onKeyPress({Enter:(e,t)=>i(t)}))}},{"../../index":1}],23:[function(e,t,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const n=e("../../index");function o(e){return Array.isArray(e)?e:e.get()}function i(e){return"string"==typeof e?e:e.value}s.select=function(e,t,s={}){const{defLabel:r=""}=s;return n.dom("select",n.dom("option",n.dom.hide(!0),r),n.dom.forEach(t,t=>{const s="string"==typeof t?{value:t,label:t}:t;return n.dom("option",{disabled:s.disabled,selected:s.value===e.get()},s.label)}),s=>n.dom.autoDisposeElem(s,n.subscribe(e,(e,n)=>{const r=o(t).findIndex(e=>i(e)===n);s.selectedIndex=r+1})),n.dom.on("change",(s,n)=>{const r=n.selectedIndex,u=o(t)[r-1];void 0!==u&&e.set(i(u))}))}},{"../../index":1}]},{},[1])(1)});
//# sourceMappingURL=grain-full.min.js.map